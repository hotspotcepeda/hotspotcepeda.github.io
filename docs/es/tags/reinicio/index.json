[{"content":"BBDD\n1 2 3 4 5 6  docker run -d \\ -v `pwd`/mysql:/var/lib/mysql \\ -v `pwd`/50-server.cnf:/etc/mysql/mariadb.conf.d/50-server.cnf:ro \\ -e MYSQL_ROOT_PASSWORD=mysqlPASWORD \\ ‚Äìname librenms-db \\ mariadb:latest   Lanza librenms, se asocia a la BBDD\n1 2 3 4 5 6 7 8 9 10 11 12 13  docker run -d \\ -v `pwd`/data:/data \\ -p 888:80 \\ -e TZ=¬ªEurope/Madrid¬ª \\ ‚Äìlink 0bd3a3993581(id container BBDD):mysql \\ -e POLLER=24 \\ -e DB_TYPE=mysql \\ -e DB_HOST=mysql \\ -e DB_NAME=librenms \\ -e DB_USER=root \\ -e DB_PASS=mysqlPASWORD \\ ‚Äìname librenms \\ seti/librenms   Al navegador http://ipserver:888/install.php\n","description":"Instalar LibreNMS en un contenedor de Docker","id":2,"section":"posts","tags":["docker","librenms","debian"],"title":"Librenms Docker install","uri":"https://hotspotcepeda.github.io/es/posts/librenms_docker_install/"},{"content":"El proposito de este sitio es:\n Compartir la experiencia del proyecto de red comunitaria en Cepeda. Archivar y mantener disponible la documentaci√≥n t√©cnica. Dar las gracias por la ayuda recibida e intentar ayudar al que lo necesite para replicar este proyecto de red comunitaria en otros lugares.  Si desea colaborar en el proyecto de Cepeda, en este sitio para aportar contenido, como redactor, traductor o simplemente para expresar su opini√≥n, le invito a contactar mediante el canal de matrix creado para esto y contribuir en github.\nPienso que las telecomunicaciones en nuestra sociedad actual tienen que estar al alcance de todas las personas y por ello las considero un derecho fundamental, como lo son la educaci√≥n o la sanidad p√∫blica. Quiero agradecer a todas esas personas que comparten su experiencia, conocimientos e informaci√≥n para ponerlas al servicio del desarrollo de la humanidad de manera desinteresada.\nTambi√©n quiero a√±adir que no soy programador profesional y que no hago esto con fines lucrativos, solo hago esto porque me gustan las telecomunicaciones y la tecnolog√≠a. Si de alguna manera me equivoco acepte mis m√°s sinceras disculpas y no dude en corregirme.\r ","description":"descripcion del sitio","id":3,"section":"","tags":null,"title":"Sitio","uri":"https://hotspotcepeda.github.io/es/sitio/"},{"content":"Fotos de la Red\n","description":"Galeria fotos de Red","id":4,"section":"gallery","tags":null,"title":"Red","uri":"https://hotspotcepeda.github.io/es/gallery/red/"},{"content":"https://wiki.openwrt.org/doc/howto/cron\r\nMe est√°n dando guerra una serie de router. El usuario se queja de que de vez en cuando el router pierde la salida a internet, una de las veces que estaba teniendo el problema me conect√© y era como que perd√≠a la ip WAN del cliente dhcp, la red local segu√≠a funcionando y la wifi tambi√©n,la parte lan estaba ok y he pensado que programando un reinicio diario de madrugada se pod√≠a arreglar el problema. (No ser√° la mejor soluci√≥n pero se arregl√≥ el problema)\nEs f√°cil solo hay que decirle al cron del router que se reinicie a una hora en la que no tenga actividad, por ejemplo las 04:30 de la madrugada. Primero hay que ponerlo en hora, activar el cliente ntp para que el trasto se ponga en hora cada vez que se encienda‚Ä¶ si no tiene ntp configurado se va a reiniciar a lo loco, y queremos que se reinicie cada d√≠a a las 04:30.\nEste es el formato de cron:\r* * * * * comando a ejecutar\r- - - - -\r| | | | |\r| | | | +----- D√≠a de la semana (0-7)\r| | | +----------- Mes (1 - 12)\r| | +----------------- D√≠a del mes (1 - 31)\r| +----------------------- Hora (0 - 23)\r+----------------------------- Minuto (0 - 59)\rPara insertar una nueva tarea en el cron:\n# crontab -e\rSe nos abre un fichero en el que ponemos esto, se trata de confirmar la hora antes de hacer el reboot para no dejar un reinicio en bucle y cargarse el trasto.\n# Reinicio todos los dias a las 04:30\r# Nota: Para evitar el bucle de reinicio infinito, espera 70 segundos\r# y crea un archivo en /etc comprueba que la fecha de creaci√≥n # marca las 4:31 antes de ejecutar el comando de reinicio de cron.\r30 4 * * * sleep 70 \u0026amp;\u0026amp; touch /etc/banner \u0026amp;\u0026amp; reboot\rPara salir de la edici√≥n del archivo usando vi:\nPresionar tecla Esc y escribir :wq , para salir sin guardar :q!\nArrancamos y activamos el servicio:\n# /etc/init.d/cron start\r# /etc/init.d/cron enable\rComprobamos que permanece y esperamos que funcione. Hasta ma√±ana!\n# crontab -l\rAl d√≠a siguiente ejecutamos un:\n# uptime\rPara ver cuanto lleva funcionando.\n","description":"Programar reinicio en OpenWRT","id":12,"section":"posts","tags":["OpenWRT","Router neutro","Reinicio"],"title":"Programar reinicio en OpenWRT","uri":"https://hotspotcepeda.github.io/es/posts/programar_reinicio_openwrt/"},{"content":"¬øQue qu√© es qMp? Visite http://qmp.cat/Inicio para conocerlo. Esta es la p√°gina de desarrollo proyecto https://dev.qmp.cat/projects/qmp üôå\r Modos de trabajo de la radio con qMp 3.2.1 Estos son los modos de trabajo en modo community, opciones de Wireless interface wlan0.\nAd_hoc_(mesh)_+_access_point_(Lan) Ad_hoc_(mesh) Access_point_(mesh) Access_point_(Lan) Client_(WAN) EXPERIMENTAL_802.11s_(mesh) EXPERIMENTAL_802.11s_(mesh)+Access_point_(Lan) Disabled la opci√≥n desaparece ","description":"Modos de trabajo de la radio con qMp","id":13,"section":"posts","tags":["OpenWRT","qMp"],"title":"Modos de trabajo qMp","uri":"https://hotspotcepeda.github.io/es/posts/modos_de_trabajo_qmp/"},{"content":"¬øQue qu√© es qMp? Visite http://qmp.cat/Inicio para conocerlo. Esta es la p√°gina de desarrollo proyecto https://dev.qmp.cat/projects/qmp üôå\r Este es el archivo de configuraci√≥n qMp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89  /etc/config/qmp Node configuration: config \u0026#39;qmp \u0026#39; \u0026#39;node \u0026#39; option \u0026#39;community_node_id \u0026#39;\t\u0026#39;901 \u0026#39; # An number identifying the node. In this case node name will be: \u0026#34;qmp901\u0026#34;. If not specified it will be auto-configured based on the last byte of the MAC address. option \u0026#39;key \u0026#39;\t\u0026#39;/tmp/ qmp_key \u0026#39; # Path to file containing the QMP key. It is a hash generated randomly on each boot used by some QMP applications for security purposes. Interfaces config \u0026#39;qmp \u0026#39; \u0026#39;interfaces \u0026#39; option \u0026#39;lan_devices \u0026#39;\t\u0026#39;eth0 wlan1 \u0026#39; # Interfaces used for nal client connection, a bridge between them will be created and the DHCP server will be enabled. option \u0026#39;wan_device \u0026#39;\t\u0026#39;eth1 \u0026#39; # Interface connection with another network. A DHCP client will be enabled in this interface to automatically get the network con\u000cguration. option \u0026#39;mesh_devices \u0026#39;\t\u0026#39;wlan0 wlan2 \u0026#39; # Interfaces used for meshing. Several VLAN will be created and routing protocols will be enabled. Networks config \u0026#39;qmp \u0026#39; \u0026#39;networks \u0026#39; option \u0026#39;dns \u0026#39;\t\u0026#39;141.1.1.1 \u0026#39; # Nameservers used for the device and final clients option \u0026#39;lan_address \u0026#39;\t\u0026#39;172.30.22.1 \u0026#39; # lan address: IPv4 address used for final client bridge interface (see 7.3.2) option \u0026#39;lan_netmask \u0026#39;\t\u0026#39;255.255.255.0 \u0026#39; # lan netmask: IPv4 netmask used for final client bridge interface option \u0026#39;niit_prefix96 \u0026#39;\t\u0026#39;0:0:0:0:0: ffff \u0026#39; # niit prefix96: Niit is used for 4in6 tunneling, see 7.2.4 option \u0026#39;mesh_protocol_vids \u0026#39;\t\u0026#39;olsr6 :1 bmx6 :2\u0026#39; # VLAN tag suffix added for routing protocol interfaces (mesh vid - offset + mesh protocol vids) option \u0026#39;mesh_vid_offset \u0026#39;\t\u0026#39;10\u0026#39; # VLAN tag offset used for routing protocol interfaces (e. eth0.10) option \u0026#39;olsr6_mesh_prefix48 \u0026#39;\t\u0026#39;fd01 :0:0 \u0026#39; # First 48 bits used for IPv6 calculation, see IP structure chapter option \u0026#39;bmx6_mesh_prefix48 \u0026#39;\t\u0026#39;fd02 :0:0 \u0026#39; option \u0026#39;babel_mesh_prefix48 \u0026#39;\t\u0026#39;fd03 :0:0 \u0026#39; option \u0026#39;netserver \u0026#39; \u0026#39;1\u0026#39; Wireless General section config \u0026#39;qmp \u0026#39; \u0026#39;wireless \u0026#39; option \u0026#39;driver \u0026#39;\t\u0026#39;mac80211 \u0026#39; # Which driver to use: mac80211 or madwi\u000c option \u0026#39;country \u0026#39;\t\u0026#39;ES \u0026#39; # country: Country code to use for WiFi devices option \u0026#39;bssid \u0026#39;\t\u0026#39;02: CA:FF:EE:BA:BE \u0026#39; # bssid: BSSID to use for Ad-Hoc devices Specific device section looks like that: config \u0026#39;wireless \u0026#39; option \u0026#39;mode \u0026#39;\t\u0026#39;adhoc \u0026#39; # WiFi supported modes are \u0026#34;adhoc\u0026#34;, \u0026#34;ap\u0026#34; or \u0026#34;none\u0026#34; option \u0026#39;name \u0026#39;\t\u0026#39;qMp \u0026#39; # WiFi SSID to use in this device option \u0026#39;txpower \u0026#39;\t\u0026#39;20\u0026#39; # txpower: Transmit power for this device option \u0026#39;channel \u0026#39;\t\u0026#39;48+ \u0026#39; # channel: Channel for this device. If +/- added, 802.11n in mode HT40 will be used option \u0026#39;mac \u0026#39;\t\u0026#39;00: AA:BB:CC:DD:EE \u0026#39; # mac: MAC identify the device option \u0026#39;device \u0026#39;\t\u0026#39;wlan0 \u0026#39; # device: Interface name used for this device Tunnels config \u0026#39;qmp \u0026#39; \u0026#39;tunnels \u0026#39; option \u0026#39;search_ipv4_tunnel \u0026#39;\t\u0026#39;0.0.0.0/0 \u0026#39; option \u0026#39;offer_ipv6_tunnel \u0026#39;\t\u0026#39;::/0 \u0026#39; Autoconfiguration system: /qmp_autoconf\t# se ejecuta solo en el primer arranque, si ya existe no se ejecuta  /etc/init.d/qmp_autoconf # a init script  # pasos del autoconf 1. Check if control file exist 2. Configure wireless devices 3. Configure networking 4. Restart affected services 5. Create control file Wireless config /etc/qmp/qmp_wireless.sh # dos funciones 1 qmp_configure_wifi_initial #  config \u0026#39;wireless \u0026#39; option \u0026#39;mode \u0026#39; \u0026#39;adhoc \u0026#39; option \u0026#39;name \u0026#39; \u0026#39;qMp -MESH \u0026#39; config \u0026#39;wireless \u0026#39; option \u0026#39;mode \u0026#39; \u0026#39;ap \u0026#39; option \u0026#39;name \u0026#39; \u0026#39;qMp -AP \u0026#39; 2 qmp_configure_wifi # in /etc/qmp/templates  wireless .# QMP_DEVICE =wifi - device wireless .# QMP_DEVICE. type = mac80211 wireless .# QMP_DEVICE. macaddr =# QMP_MAC wireless .# QMP_DEVICE. channel =# QMP_CHANNEL wireless .@wifi - iface [# QMP_INDEX ]. mode = adhoc wireless .@wifi - iface [# QMP_INDEX ]. bssid =# QMP_BSSID MANAGEMENT TOOLS qmpcontrol # is located on /etc/qmp/qmp_control.sh Usage : /usr/bin/qmpcontrol \u0026lt;function \u0026gt; [ params ] Available functions : offer_default_gw\t: Offers default gw to the network search_default_gw\t: Search for a default gw in the network configure_wifi\t: Configure and apply current wifi settings configure_network\t: Configure and apply current network settings apply_netserver\t: Start / stop netserver depending on configuration enable_ns_ppt\t: Enable POE passtrought from NanoStation M2/5 devices . Be careful with this qmpinfo # It uses the library provided by OpenWRT libiwinfo which gives information about WiFi devices. Usage : qmpinfo \u0026lt;question \u0026gt; [ options ] Available questions : modes \u0026lt;dev \u0026gt;\t: supported modes by the wireless card channels \u0026lt;dev \u0026gt;\t: supported channels and supported HT40 type (+/ -) ipv4\t: print all ipv4 from this computer ( excluding localhost ) hostname\t: print device hostname bwtest \u0026lt;ipv6 \u0026gt;\t: perform a bandwidth test nodes\t: list all nodes on MESH network key\t: print qmp key   ","description":"UCI qMp archivo de configuraci√≥n","id":14,"section":"posts","tags":["OpenWRT","qMp"],"title":"UCI qMp archivo de configuraci√≥n","uri":"https://hotspotcepeda.github.io/es/posts/uci_qmp_configuration_file/"},{"content":"De como reciclar un viejo router ADSL y convertirlo en un router neutro con software libre. Se pueden usar como firewall, como AP o por entretenimiento para aprender redes porque ofrecen muchas funciones. Cambiando el firmware del fabricante a OpenWRT se transforman en router Linux. Dejo un enlace de la lista de hardware compatible https://openwrt.org/toh/start porque seguro que tienes alg√∫n router viejo por casa y es compatible. Dependiendo del router es m√°s o menos f√°cil cargar el firmware, este router no es f√°cil y va corto de memoria pero se puede.\nhttps://openwrt.org/toh/comtrend/ct5365\n1. Seleccionar firmware: Este es un Router muy parecido al CT-5361 es un poco m√°s moderno, pero no deja de ser una patatilla, ojo puede dar mucho juego aunque tenga poca memoria.\nEstos son los ensayos que hice:\nAttitude Adjustment: http://downloads.openwrt.org/attitude_adjustment/12.09/brcm63xx/generic/openwrt-96348GW-generic-squashfs-cfe.bin Se reinicia el router al navegar por luci üëé\nhttp://downloads.openwrt.org/attitude_adjustment/12.09/brcm63xx/generic/openwrt-96348A-122-generic-squashfs-cfe.bin Se reinicia el router al navegar por luci. Por consola responde, se satura cuando navegas por el luci con pinchar un par de pesta√±as se bloquea a continuaci√≥n p√°gina de tiempo agotado y termina por reiniciarse. üëé\nBackfire http://downloads.openwrt.org/backfire/10.03.1/brcm63xx/openwrt-96348GW-generic-squashfs-cfe.bin No se enciende el power despu√©s de cargar el firmware, no da ip üëé\nhttp://downloads.openwrt.org/backfire/10.03/brcm63xx/openwrt-96348GW-generic-squashfs-cfe.bin No se enciende el power despu√©s de cargar el firmware, no da ip üëé\nhttp://downloads.openwrt.org/backfire/10.03/brcm63xx/openwrt-96348GW-11-squashfs-bc300-cfe.bin No se enciende el power despu√©s de cargar el firmware, no da ip üëé\nhttps://dl.dropbox.com/u/4708147/openwrt/bcm63xx/CT-5365/openwrt-96348GW-generic-squashfs-cfe_backfire_10.03.1.bin Enlace roto, no pude probar. ‚úã\nBarrier Breaker http://downloads.openwrt.org/barrier_breaker/14.07-rc2/brcm63xx/generic/openwrt-96348A-122-generic-squashfs-cfe.bin Se reinicia el router al navegar por luci. üëé\nBackfire (10.03.1, unknown) Compartido por plumanegra.\nhttp://www.4shared.com/file/yGiVhj8ice/openwrt-96348GW-generic-squash.html Funciona el luci y se mantiene !!! üëç\n2. Instalar el firmware Antes de instalar el firmware conviene visitar la wiki openWRT del modelo http://wiki.openwrt.org/toh/comtrend/ct5365 para echar un vistazo.\nEncender el router con el bot√≥n de reset pulsado unos 10 segundos para entrar al modo bootloader.\nFijar una IP del rango del router\n1  ifconfig eth0 192.168.1.222   Nos conectamos al a la boca X3 por ejemplo y cargamos el .bin, desde el navegador a la ip del portal bootloader 192.168.1.1 Si en alg√∫n momento del proceso al acceder por web al router para cambiar el firmware nos aparece la pagina rosa con el texto:\n404 Not Found\nFile not found.\nmicro_httpd\nVamos a las preferencias de nuestro navegador, privacidad y limpiamos la cache, esto pasa por que le hacemos un lio al navegador y ya no sabe que p√°gina entregarnos, la cache no coincide con la realidad.\r\nAhora podemos acceder a la web para subir el firmware. Pasados unos minutos se solicita ip por dhcp.\n1 2  telnet 192.168.1.1 passwd root # para fijar el password y activar el SSH   Si se interrumpe la alimentaci√≥n cuando estamos editando el firmware desp√≠dete del aparato.\r 3. Configuraci√≥n como router neutro. Cuando se pone el nuevo firmware solo se puede acceder por telnet y sin contrase√±a, el SSH se activa cuando se fija el password de root.\nDesde PC pedir ip por dhcp:\n1 2  dhclient eth0 telnet 192.168.1.1   Fijar password\n1  passwd root   Para ponerlo como router neutro editamos el /etc/config/network y lo dejamos tal que as√≠, (prestando atenci√≥n a las MAC, sumar 1 para la MAC de la WAN)\nvi /etc/config/network\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  config ‚Äòinterface‚Äô ‚Äòloopback‚Äô option ‚Äòifname‚Äô ‚Äòlo‚Äô option ‚Äòproto‚Äô ‚Äòstatic‚Äô option ‚Äòipaddr‚Äô ‚Äò127.0.0.1‚Äô option ‚Äònetmask‚Äô ‚Äò255.0.0.0‚Äô config ‚Äòswitch‚Äô ‚Äòeth1‚Äô option ‚Äòenable‚Äô ‚Äò1‚Äô option ‚Äòenable_vlan‚Äô ‚Äò1‚Äô option ‚Äòreset‚Äô ‚Äò1‚Äô config ‚Äòinterface‚Äô ‚Äòlan‚Äô option ‚Äòifname‚Äô ‚Äòeth1.1‚Äô option ‚Äòforce_link‚Äô ‚Äò1‚Äô option ‚Äòtype‚Äô ‚Äòbridge‚Äô option ‚Äòproto‚Äô ‚Äòstatic‚Äô option ‚Äòipaddr‚Äô ‚Äò192.168.1.1‚Äô option ‚Äònetmask‚Äô ‚Äò255.255.255.0‚Äô option ‚Äònat‚Äô ‚Äò1‚Äô option ip6assign ‚Äô60‚Äô option macaddr ‚Äô00:1D:XX:XX:XX:31‚Ä≤ config ‚Äòinterface‚Äô ‚Äòwan‚Äô option ‚Äòifname‚Äô ‚Äòeth1.0‚Äô option ‚Äòforce_link‚Äô ‚Äò1‚Äô option ‚Äòmacaddr‚Äô ‚Äô00:1D:XX:XX:XX:32‚Ä≤ option ‚Äòproto‚Äô ‚Äòdhcp‚Äô option ‚Äòdefaultroute‚Äô ‚Äò1‚Äô config ‚Äòswitch_vlan‚Äô option ‚Äòdevice‚Äô ‚Äòeth1‚Äô option ‚Äòvlan‚Äô ‚Äò1‚Äô option ‚Äòports‚Äô ‚Äò1 2 3 4 5t‚Äô config ‚Äòswitch_vlan‚Äô option ‚Äòdevice‚Äô ‚Äòeth1‚Äô option ‚Äòvlan‚Äô ‚Äò0‚Äô option ‚Äòports‚Äô ‚Äò0 5t‚Äô   4 Comprobaciones Guardamos los cambios y reiniciamos la configuraci√≥n de red con un /etc/init.d/network reload , lo dejamos unos minutos y conectamos la WAN, tener en cuenta que ahora los puertos del router se numeran al rev√©s, en la posici√≥n 4X est√° el port 0, es aqu√≠ donde conectamos el internet WAN. 3X 2X y 1X son las patas de LAN.\nApagamos y encendemos el router (al reiniciar interfaces se puede bloquear), y a navegar!. Ahora podemos configurar c√≥modamente la WiFi y el resto de opciones desde los men√∫s del lUCI.\n","description":"OpenWRT en Comtrend CT-5365","id":15,"section":"posts","tags":["OpenWRT","Router neutro"],"title":"OpenWRT COMTREND CT-5365","uri":"https://hotspotcepeda.github.io/es/posts/openwrt-comtrend_ct-5365/"},{"content":"De como reciclar un viejo router ADSL y convertirlo en un router neutro con software libre. Se pueden usar como firewall, como AP o por entretenimiento para aprender redes porque ofrecen muchas funciones. Cambiando el firmware del fabricante a OpenWRT se transforman en router Linux. Dejo un enlace de la lista de hardware compatible https://openwrt.org/toh/start porque seguro que tienes alg√∫n router viejo por casa y es compatible. Dependiendo del router es m√°s o menos f√°cil cargar el firmware, este router no es f√°cil y va corto de memoria pero se puede.\nhttps://openwrt.org/toh/comtrend/ct5361\n1. Seleccionar firmware: He intentado instalar un Barrier Breaker 14.07 ya compilado de seguridad wireless pero no he podido hacerlo funcionar, el router se reinicia, lo ponen como que ya tiene lUCI, pero tampoco me ha funcionado el acceso por web.\nLista de firmwares Stable:\nChaos Calmer 15.05\tDownload images\t2015 September\tr46767\nBarrier Breaker 14.07\tDownload images\t2014 October\tr42625\nAttitude Adjustment 12.09\tDownload images\t2013 April\tr36088\nBackfire 10.03.1\tDownload images\t2011 December\tr29592\nBackfire 10.03\tDownload images\t2010 April\tr20728\nKamikaze 8.09.2\tDownload images\t2010 January\tr18801\nKamikaze 8.09.1\tDownload images\t2009 June\tr16278\nKamikaze 8.09\tDownload images\t2008 September\tr14510\nKamikaze 7.09\tDownload images\t2007 September\tr7831\nKamikaze 7.07\tDownload images\t2007 July\tKamikaze 7.06\tDownload images\t2007 June\tr7204\nWhite Russian 0.9\tDownload images\t2007 January\tr6257\nAl final se han seguido los pasos de la wiki openWRT para este modelo y lo tengo funcionando con Backfire (10.03.1, r29592) el lUCI no es tan chulo como el Barrier Breaker pero sirve para trabajar igual de bien.\n2. Instalar el firmware Si en alg√∫n momento del proceso al acceder por web al router para cambiar el firmware nos aparece la pagina rosa con el texto:\n404 Not Found\nFile not found.\nmicro_httpd\nVamos a las preferencias de nuestro navegador, privacidad y limpiamos la cache, esto pasa por que le hacemos un lio al navegador y ya no sabe que p√°gina entregarnos, la cache no coincide con la realidad.\r\nEncender el router con el bot√≥n de reset pulsado unos 10 segundos para entrar al modo bootloader.\nFijar una IP del rango del router\n1  ifconfig eth0 192.168.1.222   Abrir en el navegador la direcci√≥n del router 192.168.1.1, seleccionar el fichero .bin cargarlo y esperar pacientemente a que se reinicie.\nSi se interrumpe la alimentaci√≥n cuando estamos editando el firmware desp√≠dete del aparato.\r\n3. Configuraci√≥n como router neutro. Cuando se pone el nuevo firmware solo se puede acceder por telnet y sin contrase√±a, el SSH se activa cuando se fija el password de root.\nDesde PC pedir ip por dhcp:\n1 2  dhclient eth0 telnet 192.168.1.1   Fijar password\n1  passwd root   Editar /etc/config/network.\n1  vi /etc/config/network   Borramos todo el contenido del archivo y pegamos esto directamente. (Cambiar las MAC por las del router y en la mac de la wan sumar 1).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  config ‚Äòinterface‚Äô ‚Äòloopback‚Äô option ‚Äòifname‚Äô ‚Äòlo‚Äô option ‚Äòproto‚Äô ‚Äòstatic‚Äô option ‚Äòipaddr‚Äô ‚Äò127.0.0.1‚Äô option ‚Äònetmask‚Äô ‚Äò255.0.0.0‚Äô config globals ‚Äòglobals‚Äô option ula_prefix ‚Äòxxxx:001c:xxxx::/48‚Äô config ‚Äòswitch‚Äô ‚Äòeth1‚Äô option ‚Äòenable‚Äô ‚Äò1‚Äô option ‚Äòenable_vlan‚Äô ‚Äò1‚Äô option ‚Äòreset‚Äô ‚Äò1‚Äô config ‚Äòinterface‚Äô ‚Äòlan‚Äô option ‚Äòifname‚Äô ‚Äòeth1.1‚Äô option ‚Äòforce_link‚Äô ‚Äò1‚Äô option ‚Äòtype‚Äô ‚Äòbridge‚Äô option ‚Äòproto‚Äô ‚Äòstatic‚Äô option ‚Äòipaddr‚Äô ‚Äò192.168.1.1‚Äô option ‚Äònetmask‚Äô ‚Äò255.255.255.0‚Äô option ‚Äònat‚Äô ‚Äò1‚Äô option ip6assign ‚Äô60‚Äô option macaddr ‚Äô00:30:xx:xx:xx:7B‚Äô config ‚Äòinterface‚Äô ‚Äòwan‚Äô option ‚Äòifname‚Äô ‚Äòeth1.0‚Äô option ‚Äòforce_link‚Äô ‚Äò1‚Äô option ‚Äòmacaddr‚Äô ‚Äô00:30:xx:xx:xx:7C‚Äô option ‚Äòproto‚Äô ‚Äòdhcp‚Äô option ‚Äòdefaultroute‚Äô ‚Äò1‚Äô config ‚Äòswitch_vlan‚Äô option ‚Äòdevice‚Äô ‚Äòeth1‚Äô option ‚Äòvlan‚Äô ‚Äò1‚Äô option ‚Äòports‚Äô ‚Äò1 2 3 4 5t‚Äô config ‚Äòswitch_vlan‚Äô option ‚Äòdevice‚Äô ‚Äòeth1‚Äô option ‚Äòvlan‚Äô ‚Äò0‚Äô option ‚Äòports‚Äô ‚Äò0 5t‚Äô   Guardar y reiniciar la configuraci√≥n de los interfaces, esto tarda:\n1  /etc/init.d/network reload   4 Comprobaciones Olv√≠date de la rotulaci√≥n de interfaces que tra√≠a el router de origen, ahora se quedan as√≠:\nConectar internet a la WAN 0 y pc a LAN 1 2 √≥ 3\n1 2  dhclient eth0 ssh 192.168.1.1   Ahora desde el router y desde nuestra maquina se alcanza internet ya se pueden actualizar o instalar paquetes.\n1 2  ping 8.8.8.8 opkg update   Para configurar la wifi y resto de opciones ya se puede hacer por lUCI.\n","description":"OpenWRT en Comtrend CT-5361","id":16,"section":"posts","tags":["OpenWRT","Router neutro"],"title":"OpenWRT COMTREND CT-5361","uri":"https://hotspotcepeda.github.io/es/posts/openwrt-comtrend_ct-5361/"},{"content":"https://ralph-ng.readthedocs.io/\nRalph es un sistema de gesti√≥n de activos, DCIM y CMDB simple pero potente para centros de datos y back office.\nCaracter√≠sticas:\n realizar un seguimiento de las compras de activos y su ciclo de vida sistema de flujo flexible para el ciclo de vida de los activos centro de datos y soporte de back office Visualizaci√≥n dc incorporada  Ralph en Docker 1 2 3  docker run -i -t --name=\u0026#34;mysql_ralph\u0026#34; -v /var/lib/mysql -v /home/ralph/.ralph busybox /bin/sh -c \u0026#34;chown root /home/ralph; chown root /home/ralph/.ralph\u0026#34; docker run -P -t -i --volumes-from mysql_ralph allegrogroup/ralph:latest /bin/bash /home/ralph/init.sh docker run -P -p 8000:8000 -t -i --name ralph --mac-address=02:42:ac:11:ff:ff --volumes-from mysql_ralph allegrogroup/ralph:latest   Compose\nhttps://ralph-ng.readthedocs.io/en/stable/\nInstall\nInstall docker and docker-compose first.\nCreate compose configuration\nCopy docker-compose.yml.tmpl outside ralph sources to docker-compose.yml and tweak it.\nBuild\nThen build ralph:\n1  docker-compose build   To initialize database run:\n1  docker-compose run --rm web /root/init.sh   Notice that this command should be executed only once, at the very beginning.\nIf you need to populate Ralph with some demonstration data run:\n1  docker-compose run --rm web ralph demodata   Run ralph at the end:\n1  docker-compose up -d   Ralph should be accessible at http://127.0.0.1 (or if you are using boot2docker at $(boot2docker ip)). Documentation is available at http://127.0.0.1/docs.\nIf you are upgrading ralph image (source code) run:\n1  docker-compose run --rm web /root/upgrade.sh   ","description":"Ralph Docker install","id":17,"section":"posts","tags":["ralph","docker"],"title":"Ralph en Docker","uri":"https://hotspotcepeda.github.io/es/posts/ralph/"},{"content":"Cepeda la Mora\n","description":"Fotos de Cepeda","id":18,"section":"gallery","tags":null,"title":"Paisaje","uri":"https://hotspotcepeda.github.io/es/gallery/paisaje/"},{"content":"Me decid√≠ a formular una propuesta para el despliegue de la red en Cepeda, como no tenia ni idea le present√© al alcalde un pdf con al idea que ten√≠a, a lo que el alcalde respond√≥, \u0026ldquo;Mira a mi no me vengas con cosas t√©cnicas, si quieres hacerlo. adelante. Te voy a ayudar en lo que pueda\u0026rdquo;\n","description":"La Propuesta que se hizo al Ayto","id":19,"section":"posts","tags":["guifi.net","qMp"],"title":"La propuesta","uri":"https://hotspotcepeda.github.io/es/posts/la_propuesta/"},{"content":"Y se puso en producci√≥n el hotspot, un hotspot en wifi es un dispositivo con capacidades de enrutamiento que gestiona conexiones de otros dispositivos (punto caliente) y les da salida a internet, una especie de pasarela o gateway pero en este caso con capacidades de gesti√≥n del trafico.\nLa salida a internet para toda la red comunitaria la dona el excelent√≠simo Ayto de Cepeda la Mora, es un router 4G de 10 Mb dedicado.\nHardware MikroTik Para hacer la gesti√≥n de los dispositivos que se conectan a pie de calle se usa una ROUTERBOARD MIKROTIK RB750GL, este router est√° dedicado solo para esta tarea, lleva funcionando 24x7 desde el a√±o 2014 de la era pre-covid.\nUbiquiti La red de captaci√≥n del hotspot va toda en 2.4 Ghz, APs en 802.11b para que se puedan conectar dispositivos antiguos.\nEl AP de la plaza Ubiquiti NanoStation 2 est√° en modo AP bridge, debe de tener mas de 10 a√±os, es de cuando ven√≠an con un latiguillo de 3 metros de color azul, \u0026hellip; que tiempos aquellos.\nPara extender la red del hotspot hay en enlace en 2.4 del Ayto al Bar municipal \u0026ldquo;El Traite\u0026rdquo; con Ubiquiti NanoStation Loco M2.\nOpenWRT Para la captaci√≥n en el Bar se usa de AP un router Comtrend AR-5387un https://openwrt.org/toh/comtrend/ar5387un liberado con OpenWRT, ni un problema, 24x7 desde 2014 m√°s lo que llevara funcionando de antes.\nConexiones MikroTik graph TD;\rROUTERBOARD_MIKROTIK_RB750GL--\u0026gt;WAN_ether1;\rROUTERBOARD_MIKROTIK_RB750GL--\u0026gt;Libre_ether2;\rROUTERBOARD_MIKROTIK_RB750GL--\u0026gt;Gesti√≥n_ether3;\rROUTERBOARD_MIKROTIK_RB750GL--\u0026gt;bridge1_ether4;\rbridge1_ether4--\u0026gt;AP_NS2_plaza_Ayto;\rROUTERBOARD_MIKROTIK_RB750GL--\u0026gt;bridge1_ether5;\rbridge1_ether5--\u0026gt;enl_NSlocoM2_a;\renl_NSlocoM2_a--\u0026gt;enl_NSlocoM2_b;\renl_NSlocoM2_b--\u0026gt;AP_OpenWRT_Bar_Municipal;\rConfiguraci√≥n MikroTik 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480  [admin@hostname] \u0026gt; export # mar/14/2021 01:23:15 by RouterOS 6.43.2 # software id = LVV0-IUW2 # # model = 750GL # serial number = 888A02585888 /interface bridge add comment=LAN fast-forward=no mtu=1500 name=bridge1 protocol-mode=none /interface ethernet set [ find default-name=ether1 ] comment=\u0026#34;WAN ether1\u0026#34; name=Lan speed=100Mbps set [ find default-name=ether2 ] speed=100Mbps set [ find default-name=ether3 ] comment=GESTION speed=100Mbps set [ find default-name=ether4 ] comment=-AP-HOSTSPOT disabled=yes speed=100Mbps set [ find default-name=ether5 ] comment=-HS_NANO_ENL speed=100Mbps /interface list add name=mactel add name=mac-winbox /interface wireless security-profiles set [ find default=yes ] supplicant-identity=hostname /ip firewall layer7-protocol add name=youtube regexp=\u0026#34;(GET \\\\/videoplayback\\\\\\?|GET \\\\/crossdomain\\\\.xml)\u0026#34; add name=torrentsites regexp=\u0026#34;^.*(get|GET).+(torrent|thepiratebay|isohunt|entertane|demonoid|btjunkie|mininova|flixflux|torrentz|vertor|h33t|btscene|bitunity|bittoxic|thunderbytes|entertane|zoozle|vcdq|bitnova|bitsoup|meganova|fulldls|btbot|flixflux|\\ seedpeer|fenopy|gpirate|commonbits).*\\$\u0026#34; add name=p2p_www regexp=\u0026#34;^.*(get|GET).+(torrent|thepiratebay|isohunt|entertane|demonoid|btjunkie|mininova|flixflux|vertor|h33t|zoozle|bitnova|bitsoup|meganova|fulldls|btbot|fenopy|gpirate|commonbits).*\\$\u0026#34; add name=p2p_dns regexp=\u0026#34;^.+(torrent|thepiratebay|isohunt|entertane|demonoid|btjunkie|mininova|flixflux|vertor|h33t|zoozle|bitnova|bitsoup|meganova|fulldls|btbot|fenopy|gpirate|commonbits).*\\$\u0026#34; /ip hotspot profile add dns-name=guifi.net_Acceso_Abierto hotspot-address=192.168.100.1 login-by=http-chap,trial name=hsprof2 trial-uptime-limit=2d trial-uptime-reset=23h59m /ip hotspot add interface=bridge1 name=hotspot1 profile=hsprof2 /ip hotspot user profile set [ find default=yes ] add-mac-cookie=no keepalive-timeout=none name=usuarios on-login=\u0026#34;#Keep alive para limitar la sesion diaria a un tiempo\u0026#34; open-status-page=http-login rate-limit=\u0026#34;1M/1M 2M/2M 320k/320k 8/8 1 320/320\u0026#34; shared-users=1000 \\  transparent-proxy=yes /ip ipsec proposal set [ find default=yes ] enc-algorithms=3des /ip pool add name=hs-pool-4 ranges=192.168.100.10-192.168.100.254 add name=pool_gestion ranges=192.168.88.100-192.168.88.200 /ip dhcp-server add add-arp=yes address-pool=hs-pool-4 authoritative=after-2sec-delay disabled=no interface=bridge1 lease-time=1d name=dhcp_HS add add-arp=yes address-pool=pool_gestion disabled=no interface=ether3 name=dhcp_gestion /ip hotspot user profile add address-pool=hs-pool-4 name=sincontrol transparent-proxy=yes /queue simple add burst-limit=3M/3M burst-threshold=256k/256k burst-time=8s/8s disabled=yes max-limit=2M/2M name=queue1 packet-marks=clientes_2M target=ether4 /queue tree add disabled=yes name=cliente_2M_up packet-mark=clientes_2M parent=ether4 priority=1 add disabled=yes name=cliente_2M_down packet-mark=clientes_2M parent=ether4 priority=1 add max-limit=5M name=Download parent=bridge1 priority=1 add max-limit=300k name=Upload parent=Lan priority=1 /queue type add kind=pcq name=PCQ_download_2mb pcq-classifier=dst-address pcq-rate=2M add kind=pcq name=PCQ_upload_300k pcq-classifier=src-address pcq-rate=300k add kind=sfq name=BAJADA add kind=sfq name=SUBIDA /queue simple add comment=\u0026#34;# l\\EDmite global (compartido por todos los usuarios):\\r\\ \\n# 5M subida\\r\\ \\n# 35M bajada\\r\\ \\n# \\r\\ \\n# segmento de red de los clientes con este paquete de datos,\\r\\ \\n# puede usarse una interfaz de ser necesario:\\r\\ \\n# 10.10.12.0/24\u0026#34; limit-at=384k/5M max-limit=384k/5M name=2MB_down_384MB_up queue=PCQ_upload_300k/PCQ_download_2mb target=bridge1 total-queue=default /queue tree add disabled=yes max-limit=32k name=P2P packet-mark=p2p-qos parent=bridge1 queue=default add comment=\u0026#34;una cola para el total del tr\\E1fico de bajada, aqu\\ED se especifica\\r\\ \\n# la interfaz desde la que se reparte el tr\\E1fico a los clientes\u0026#34; disabled=yes limit-at=8M max-limit=8M name=\u0026#34;Total download\u0026#34; parent=bridge1 priority=1 queue=default add comment=\u0026#34;una cola para el total del tr\\E1fico de subida, aqu\\ED se especifica\\r\\ \\n# la interfaz desde la que se env\\EDa el tr\\E1fico al gateway \u0026#34; disabled=yes limit-at=300k max-limit=300k name=\u0026#34;Total upload\u0026#34; parent=Lan priority=1 queue=default add comment=\u0026#34;hoja (cola hija) de bajada para el tr\\E1fico web (HTTP), utiliza\\r\\ \\n# la marca establecida en la tabla mangle del firewall\u0026#34; disabled=yes limit-at=1M max-limit=6M name=HTTP_D packet-mark=priority_packet parent=\u0026#34;Total download\u0026#34; priority=3 queue=default add comment=\u0026#34;hoja de subida para el tr\\E1fico web (HTTP), utiliza la misma marca\\r\\ \\n# de la cola anterior\u0026#34; disabled=yes limit-at=100k max-limit=200k name=HTTP_U packet-mark=priority_packet parent=\u0026#34;Total upload\u0026#34; priority=3 queue=default add comment=\u0026#34;los paquetes con marca \\\u0026#34;other-internet\\\u0026#34; tienen una menor prioridad\\r\\ \\n# que los paquetes web, es necesario especificar estas colas, de lo\\r\\ \\n# contrario el tr\\E1fico no gestionado pasar\\E1 con la mayor prioridad\u0026#34; disabled=yes limit-at=500k max-limit=1M name=OTHER_D packet-mark=no_priority_packet parent=\u0026#34;Total download\u0026#34; priority=4 queue=default add comment=\u0026#34;los paquetes con marca \\\u0026#34;other-internet\\\u0026#34; tienen una menor prioridad\\r\\ \\n# que los paquetes web, es necesario especificar estas colas, de lo\\r\\ \\n# contrario el tr\\E1fico no gestionado pasar\\E1 con la mayor prioridad\u0026#34; disabled=yes limit-at=50k max-limit=100k name=OTHER_U packet-mark=no_priority_packet parent=\u0026#34;Total upload\u0026#34; priority=4 queue=default add name=PRIO1 packet-mark=\u0026#34;PRIO 1\u0026#34; parent=Download priority=1 queue=BAJADA add name=PRIO2 packet-mark=\u0026#34;PRIO 2\u0026#34; parent=Download priority=2 queue=BAJADA add name=PRIO3 packet-mark=\u0026#34;PRIO 3\u0026#34; parent=Download priority=3 queue=BAJADA add name=PRIO4 packet-mark=\u0026#34;PRIO 4\u0026#34; parent=Download priority=4 queue=BAJADA add name=PRIO5 packet-mark=\u0026#34;PRIO 5\u0026#34; parent=Download priority=5 queue=BAJADA add name=PRIO7 packet-mark=\u0026#34;PRIO 7\u0026#34; parent=Download priority=7 queue=BAJADA add name=PRIO8 packet-mark=\u0026#34;PRIO 8\u0026#34; parent=Download queue=BAJADA add name=PRIO.1 packet-mark=\u0026#34;PRIO 1\u0026#34; parent=Upload priority=1 queue=SUBIDA add name=PRIO.2 packet-mark=\u0026#34;PRIO 2\u0026#34; parent=Upload priority=2 queue=SUBIDA add name=PRIO.3 packet-mark=\u0026#34;PRIO 3\u0026#34; parent=Upload priority=3 queue=SUBIDA add name=PRIO.4 packet-mark=\u0026#34;PRIO 4\u0026#34; parent=Upload priority=4 queue=SUBIDA add name=PRIO.5 packet-mark=\u0026#34;PRIO 5\u0026#34; parent=Upload priority=5 queue=SUBIDA add name=PRIO.7 packet-mark=\u0026#34;PRIO 7\u0026#34; parent=Upload priority=7 queue=SUBIDA add name=PRIO.8 packet-mark=\u0026#34;PRIO 8\u0026#34; parent=Upload queue=SUBIDA /snmp community set [ find default=yes ] addresses=0.0.0.0/0 /system logging action set 0 memory-lines=100 set 1 disk-lines-per-file=100 set 3 remote=192.168.1.213 /interface bridge port add bridge=bridge1 hw=no interface=ether4 add bridge=bridge1 hw=no interface=ether5 /interface bridge settings set use-ip-firewall=yes /interface list member add interface=ether2 list=mactel add interface=ether3 list=mactel add interface=ether2 list=mac-winbox add interface=ether4 list=mactel add interface=ether3 list=mac-winbox add interface=ether5 list=mactel add interface=ether4 list=mac-winbox add interface=ether5 list=mac-winbox /ip address add address=10.228.150.3/28 comment=\u0026#34;GW Ayto\u0026#34; interface=Lan network=10.228.150.0 add address=192.168.100.1/24 comment=\u0026#34;GW hotspot\u0026#34; interface=bridge1 network=192.168.100.0 add address=192.168.88.1/24 interface=ether3 network=192.168.88.0 /ip dhcp-server network add address=192.168.88.0/24 comment=\u0026#34;default configuration\u0026#34; gateway=192.168.88.1 add address=192.168.100.0/24 gateway=192.168.100.1 /ip dns set allow-remote-requests=yes cache-size=10096KiB max-udp-packet-size=512 servers=10.228.150.6,8.8.4.4 /ip firewall address-list add list=Syn_Flooder add disabled=yes list=spammers add disabled=yes list=support add address=192.168.100.0/24 list=Cliente_2M add address=10.228.150.0/28 list=guifi.net /ip firewall filter add action=accept chain=input comment=\u0026#34;Accept to established connections\u0026#34; connection-state=established add action=accept chain=input comment=\u0026#34;Accept to related connections\u0026#34; connection-state=related add action=drop chain=forward comment=\u0026#34;Filtra paquetes chungos\u0026#34; connection-state=invalid add action=passthrough chain=unused-hs-chain comment=\u0026#34;place hotspot rules here ----------- place hotspot rules here ----------- place hotspot rules here ----------- place hotspot rules here ----------- place hotspot rules here ----------- place hotsp\\ ot rules here ----------- place hotspot rules here ----------- \u0026#34; add action=jump chain=output comment=\u0026#34;Jump for icmp output\u0026#34; disabled=yes jump-target=ICMP protocol=icmp add action=add-src-to-address-list address-list=Syn_Flooder address-list-timeout=30m chain=input comment=\u0026#34;Add Syn Flood IP to the list\u0026#34; connection-limit=30,32 protocol=tcp tcp-flags=syn add action=drop chain=input comment=\u0026#34;Drop to syn flood list\u0026#34; src-address-list=Syn_Flooder add action=drop chain=input comment=\u0026#34;Drop to syn flood list\u0026#34; disabled=yes src-address-list=Syn_Flooder add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;Port scanners to list \u0026#34; protocol=tcp psd=21,3s,3,1 add action=log chain=input comment=\u0026#34;Port Scanner Detect LOG\u0026#34; log-prefix=\u0026#34;PORT SCAN\u0026#34; protocol=tcp psd=21,3s,3,1 add action=log chain=input comment=\u0026#34;Port Scanner Detect LOG\u0026#34; disabled=yes log-prefix=\u0026#34;PORT SCAN\u0026#34; protocol=tcp psd=21,3s,3,1 add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;NMAP FIN Stealth scan\u0026#34; protocol=tcp tcp-flags=fin,!syn,!rst,!psh,!ack,!urg add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;SYN/FIN scan\u0026#34; protocol=tcp tcp-flags=fin,syn add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;SYN/RST scan\u0026#34; protocol=tcp tcp-flags=syn,rst add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;SYN/FIN scan\u0026#34; protocol=tcp tcp-flags=fin,syn add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;SYN/RST scan\u0026#34; protocol=tcp tcp-flags=syn,rst add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;FIN/PSH/URG scan\u0026#34; protocol=tcp tcp-flags=fin,psh,urg,!syn,!rst,!ack add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;FIN/PSH/URG scan\u0026#34; protocol=tcp tcp-flags=fin,psh,urg,!syn,!rst,!ack add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;ALL/ALL scan\u0026#34; protocol=tcp tcp-flags=fin,syn,rst,psh,ack,urg add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;NMAP NULL scan\u0026#34; protocol=tcp tcp-flags=!fin,!syn,!rst,!psh,!ack,!urg add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;NMAP FIN Stealth scan\u0026#34; protocol=tcp tcp-flags=fin,!syn,!rst,!psh,!ack,!urg add action=log chain=input comment=\u0026#34;Port Scanner Detect LOG\u0026#34; log-prefix=\u0026#34;PORT SCAN\u0026#34; protocol=tcp tcp-flags=fin,syn,rst,psh,ack,urg add action=add-src-to-address-list address-list=Port_Scanner address-list-timeout=1w chain=input comment=\u0026#34;Port Scanner Detect\u0026#34; protocol=tcp psd=21,3s,3,1 add action=drop chain=input comment=\u0026#34;dropping port scanners\u0026#34; src-address-list=\u0026#34;port scanners\u0026#34; add action=jump chain=input comment=\u0026#34;Jump for icmp input flow\u0026#34; disabled=yes jump-target=ICMP protocol=icmp add action=jump chain=forward comment=\u0026#34;Jump for icmp forward flow\u0026#34; disabled=yes jump-target=ICMP protocol=icmp add action=drop chain=input comment=\u0026#34;drop ftp brute forcers\u0026#34; dst-port=21 protocol=tcp src-address-list=ftp_blacklist add action=drop chain=input comment=\u0026#34;drop ssh brute forcers\u0026#34; dst-port=22 protocol=tcp src-address-list=ssh_blacklist add action=add-src-to-address-list address-list=ssh_blacklist address-list-timeout=1w3d chain=input connection-state=new dst-port=22 protocol=tcp src-address-list=ssh_stage3 add action=add-src-to-address-list address-list=ssh_stage3 address-list-timeout=1m chain=input connection-state=new dst-port=22 protocol=tcp src-address-list=ssh_stage2 add action=add-src-to-address-list address-list=ssh_stage2 address-list-timeout=1m chain=input connection-state=new dst-port=22 protocol=tcp src-address-list=ssh_stage1 add action=add-src-to-address-list address-list=ssh_stage1 address-list-timeout=1m chain=input connection-state=new dst-port=22 protocol=tcp add action=drop chain=forward comment=\u0026#34;drop ssh brute downstream\u0026#34; dst-port=22 protocol=tcp src-address-list=ssh_blacklist add action=drop chain=ICMP comment=\u0026#34;Drop to the other ICMPs\u0026#34; disabled=yes protocol=icmp add action=drop chain=forward comment=\u0026#34;Drop to bogon list\u0026#34; dst-address-list=bogons add action=add-src-to-address-list address-list=spammers address-list-timeout=3h chain=forward comment=\u0026#34;Add Spammers to the list for 3 hours\u0026#34; connection-limit=30,32 dst-port=25,587 limit=30/1m,0 protocol=tcp add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;ALL/ALL scan\u0026#34; protocol=tcp tcp-flags=fin,syn,rst,psh,ack,urg add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;NMAP NULL scan\u0026#34; protocol=tcp tcp-flags=!fin,!syn,!rst,!psh,!ack,!urg add action=add-src-to-address-list address-list=Syn_Flooder address-list-timeout=30m chain=input comment=\u0026#34;Add Syn Flood IP to the list\u0026#34; connection-limit=30,32 protocol=tcp tcp-flags=syn add action=add-src-to-address-list address-list=\u0026#34;port scanners\u0026#34; address-list-timeout=2w chain=input comment=\u0026#34;Port scanners to list \u0026#34; protocol=tcp psd=21,3s,3,1 add action=drop chain=forward comment=\u0026#34;DENIEGO ICMP\u0026#34; disabled=yes protocol=icmp add action=accept chain=input comment=\u0026#34;Accept DNS - UDP\u0026#34; port=53 protocol=udp add action=accept chain=input comment=\u0026#34;Accept DNS - TCP\u0026#34; port=53 protocol=tcp add action=accept chain=forward comment=\u0026#34;ACEPTAR FTP \u0026#34; connection-state=established connection-type=ftp protocol=0 add action=accept chain=input comment=\u0026#34;Full access to SUPPORT address list\u0026#34; src-address-list=support add action=accept chain=ICMP comment=\u0026#34;Echo request - Avoiding Ping Flood\u0026#34; icmp-options=8:0 limit=1,5 protocol=icmp add action=accept chain=ICMP comment=\u0026#34;Echo reply\u0026#34; icmp-options=0:0 protocol=icmp add action=accept chain=ICMP comment=\u0026#34;Time Exceeded\u0026#34; icmp-options=11:0 protocol=icmp add action=accept chain=ICMP comment=\u0026#34;Destination unreachable\u0026#34; icmp-options=3:0-1 protocol=icmp add action=accept chain=ICMP comment=PMTUD icmp-options=3:4 protocol=icmp add action=drop chain=ICMP comment=\u0026#34;Drop to the other ICMPs\u0026#34; disabled=yes protocol=icmp add action=log chain=input log-prefix=\u0026#34;PING DENEGADO\u0026#34; protocol=icmp add action=drop chain=virus comment=\u0026#34;VIRUS DE WINDOWS\u0026#34; dst-port=135-139,445 protocol=tcp add action=log chain=virus comment=\u0026#34;LOG VIRUS DE WINDOWS\u0026#34; dst-port=135-139,445 log-prefix=\u0026#34;VIRUS WINDOWS\u0026#34; protocol=tcp add action=jump chain=input jump-target=virus add action=drop chain=input comment=\u0026#34;Bloqueo DNS cache externo\u0026#34; dst-port=53 protocol=udp add action=drop chain=forward comment=\u0026#34;Todo P2P\u0026#34; connection-mark=p2p-conn disabled=yes add action=drop chain=input comment=\u0026#34;DROP INPUT P2P\u0026#34; connection-mark=p2p-conn disabled=yes add action=drop chain=input comment=\u0026#34;DROP OUTPUT P2P\u0026#34; connection-mark=p2p-conn disabled=yes add action=drop chain=input comment=\u0026#34;corta ping packetes de 99 bytes a m\\E1s.\u0026#34; packet-size=128-65535 protocol=icmp add action=log chain=input log-prefix=\u0026#34;PING DENEGADO\u0026#34; protocol=icmp add action=drop chain=input comment=\u0026#34;corta ping\u0026#34; disabled=yes protocol=icmp src-address-list=!guifi.net add action=add-src-to-address-list address-list=\u0026#34;IP\u0026#39;s totales\u0026#34; address-list-timeout=none-dynamic chain=forward disabled=yes src-address=192.168.0.0/16 add action=add-src-to-address-list address-list=acceso-winbox address-list-timeout=none-dynamic chain=input dst-port=8291 protocol=tcp add action=add-src-to-address-list address-list=Port_Scanner address-list-timeout=1w chain=input comment=\u0026#34;Port Scanner Detect PUEDE LLEGAR A CERRAR EL PUERTO FPT SI HAY MUCHA ACTIVIDAD, LO PONE EN LA LISTA COMO SCANER DE PUERTOS \u0026#34; protocol=tcp psd=\\  21,3s,3,1 add action=drop chain=forward comment=\u0026#34;Drop to bogon list\u0026#34; dst-address-list=bogons add action=add-src-to-address-list address-list=spammers address-list-timeout=3h chain=forward comment=\u0026#34;Add Spammers to the list for 3 hours\u0026#34; connection-limit=30,32 dst-port=25,587 limit=30/1m,0 protocol=tcp add action=drop chain=forward comment=\u0026#34;Avoid spammers action\u0026#34; dst-port=25,587 protocol=tcp src-address-list=spammers add action=drop chain=forward comment=\u0026#34;Limitar Numero de conexiones UDP por cliente\u0026#34; connection-state=new disabled=yes dst-port=!53,67,123 limit=30,40:packet protocol=udp add action=drop chain=forward comment=\u0026#34;default configuration\u0026#34; disabled=yes protocol=icmp add action=accept chain=input comment=\u0026#34;default configuration\u0026#34; connection-state=related disabled=yes add action=accept chain=input comment=\u0026#34;default configuration\u0026#34; connection-state=established disabled=yes add action=drop chain=input comment=\u0026#34;default configuration\u0026#34; disabled=yes in-interface=Lan add action=accept chain=input comment=\u0026#34;DENIEGO ICMP\u0026#34; disabled=yes protocol=icmp add action=accept chain=forward comment=\u0026#34;Reglas Firewall Basicas\u0026#34; connection-state=related add action=accept chain=forward connection-state=established add action=drop chain=input comment=\u0026#34;FIltra ICMP Redirect\u0026#34; icmp-options=5:0-255 protocol=icmp add action=log chain=input comment=\u0026#34;Port Scanner Detect LOG\u0026#34; log-prefix=\u0026#34;PORT SCAN\u0026#34; protocol=tcp tcp-flags=fin,!syn,!rst,!psh,!ack,!urg add action=log chain=input comment=\u0026#34;Port Scanner Detect LOG\u0026#34; log-prefix=\u0026#34;PORT SCAN\u0026#34; protocol=tcp tcp-flags=fin,syn,rst,psh,ack,urg,!syn,!rst,!ack,!urg add action=accept chain=output content=\u0026#34;530 Login incorrect\u0026#34; dst-limit=1/1m,9,dst-address/1m protocol=tcp add action=add-dst-to-address-list address-list=ftp_blacklist address-list-timeout=3h chain=output content=\u0026#34;530 Login incorrect\u0026#34; protocol=tcp add action=jump chain=input comment=\u0026#34;Jump for icmp input flow\u0026#34; jump-target=ICMP protocol=icmp add action=jump chain=forward comment=\u0026#34;Jump for icmp forward flow\u0026#34; jump-target=ICMP protocol=icmp add action=drop chain=input comment=\u0026#34;Block all access to the winbox - except to support list # DO NOT ENABLE THIS RULE BEFORE ADD YOUR SUBNET IN THE SUPPORT ADDRESS LIST\u0026#34; disabled=yes dst-port=8291 protocol=tcp src-address-list=!support add action=drop chain=input comment=\u0026#34;Drop anything else! # DO NOT ENABLE THIS RULE BEFORE YOU MAKE SURE ABOUT ALL ACCEPT RULES YOU NEED\u0026#34; disabled=yes add action=drop chain=input comment=\u0026#34;ultimo lugar todo lo que viene de fuera se descarta\u0026#34; disabled=yes in-interface=Lan add action=drop chain=input comment=\u0026#34;Block all access to the winbox - except to support list # DO NOT ENABLE THIS RULE BEFORE ADD YOUR SUBNET IN THE SUPPORT ADDRESS LIST\u0026#34; disabled=yes dst-port=8291 protocol=tcp src-address-list=!support add action=drop chain=forward disabled=yes p2p=all-p2p add action=drop chain=forward comment=\u0026#34;block p2p_www\u0026#34; layer7-protocol=p2p_www add action=drop chain=forward comment=\u0026#34;block p2p_dns\u0026#34; dst-port=53 layer7-protocol=p2p_dns protocol=udp add action=add-src-to-address-list address-list=acceso-winbox address-list-timeout=none-dynamic chain=input dst-port=8292 protocol=tcp /ip firewall mangle add action=mark-connection chain=prerouting comment=\u0026#34;PRIO - 7 MULTIDESCARGAS\u0026#34; connection-bytes=50000000-0 new-connection-mark=\u0026#34;PRIO 7\u0026#34; passthrough=yes protocol=tcp add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 7\u0026#34; new-packet-mark=\u0026#34;PRIO 7\u0026#34; passthrough=yes add action=jump chain=prerouting jump-target=\u0026#34;TERMINO DE PROCESAR\u0026#34; packet-mark=\u0026#34;PRIO 7\u0026#34; add action=mark-connection chain=prerouting comment=\u0026#34;MARCO PRIO 1\u0026#34; new-connection-mark=\u0026#34;PRIO 1\u0026#34; passthrough=yes protocol=icmp add action=mark-connection chain=output dst-port=53 new-connection-mark=\u0026#34;PRIO 1\u0026#34; passthrough=yes protocol=udp add action=mark-connection chain=prerouting dst-port=53 new-connection-mark=\u0026#34;PRIO 1\u0026#34; passthrough=yes protocol=udp add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 1\u0026#34; new-packet-mark=\u0026#34;PRIO 1\u0026#34; passthrough=yes add action=jump chain=prerouting jump-target=\u0026#34;TERMINO DE PROCESAR\u0026#34; packet-mark=\u0026#34;PRIO 1\u0026#34; add action=mark-connection chain=prerouting comment=\u0026#34;MARCO PRIO 2 , STREAMING - JUEGOS,VOIP\u0026#34; dst-port=5060-5061 new-connection-mark=\u0026#34;PRIO 2\u0026#34; passthrough=yes protocol=udp add action=mark-connection chain=prerouting dst-port=1863,5190,777 new-connection-mark=\u0026#34;PRIO 2\u0026#34; passthrough=yes protocol=tcp add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 2\u0026#34; new-packet-mark=\u0026#34;PRIO 2\u0026#34; passthrough=yes add action=jump chain=prerouting jump-target=\u0026#34;TERMINO DE PROCESAR\u0026#34; packet-mark=\u0026#34;PRIO 2\u0026#34; add action=mark-connection chain=prerouting comment=\u0026#34;marco prio 3 navegacion\u0026#34; dst-port=80,443,8000-9000 new-connection-mark=\u0026#34;PRIO 3\u0026#34; passthrough=yes protocol=tcp add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 3\u0026#34; new-packet-mark=\u0026#34;PRIO 3\u0026#34; passthrough=yes add action=jump chain=prerouting jump-target=\u0026#34;TERMINO DE PROCESAR\u0026#34; packet-mark=\u0026#34;PRIO 3\u0026#34; add action=mark-connection chain=prerouting comment=\u0026#34;PRIO 4 - PUERTOS LABORALES\u0026#34; dst-port=25,110,143,3389,1723,21-23 new-connection-mark=\u0026#34;PRIO 4\u0026#34; passthrough=yes protocol=tcp add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 4\u0026#34; new-packet-mark=\u0026#34;PRIO 4\u0026#34; passthrough=yes add action=jump chain=prerouting jump-target=\u0026#34;TERMINO DE PROCESAR\u0026#34; packet-mark=\u0026#34;PRIO 4\u0026#34; add action=mark-connection chain=prerouting comment=\u0026#34;MARCO PRIO 5\u0026#34; new-connection-mark=\u0026#34;PRIO 5\u0026#34; passthrough=yes add action=mark-packet chain=prerouting connection-mark=\u0026#34;PRIO 5\u0026#34; new-packet-mark=\u0026#34;PRIO 5\u0026#34; passthrough=yes add action=accept chain=\u0026#34;TERMINO DE PROCESAR\u0026#34; /ip firewall nat add action=masquerade chain=srcnat comment=\u0026#34;default configuration\u0026#34; out-interface=Lan to-addresses=0.0.0.0 /ip firewall service-port set ftp disabled=yes set tftp disabled=yes set irc disabled=yes set h323 disabled=yes set sip disabled=yes set pptp disabled=yes /ip hotspot ip-binding ... ... /ip hotspot service-port set ftp disabled=yes /ip hotspot user add name=admin password=password profile=admin server=hotspot1 add name=usuario password=usuario server=hotspot1 add disabled=yes name=usuario@correo.com password=password123 server=hotspot1 /ip hotspot walled-garden add disabled=yes dst-host=www.google.es server=hotspot1 src-address=0.0.0.0 add comment=\u0026#34;place hotspot rules here\u0026#34; disabled=yes add dst-host=guifi.net add dst-host=*.guifi.net*/* add dst-host=gg.google.com add dst-host=maps.google.com add dst-host=khm0.google.com add dst-host=khm1.google.com add dst-host=khm2.google.com add dst-host=khm3.google.com add dst-host=mt0.google.com add dst-host=mt1.google.com add dst-host=mt2.google.com add dst-host=mt3.google.com add dst-host=maps.gstatic.com add dst-host=gg.google.com add dst-host=id.google.com add dst-host=www.google-analytics.com add dst-host=www.heywhatsthat.com add dst-host=ocsp.thawte.com add dst-host=https://securityinabox.org/es*/* add dst-host=http://www.eltiempo.es/* add dst-host=http://elrollodecepeda.wordpress.com/* add dst-host=http://cepedadelamora.blogspot.com/* add dst-host=https://llistes.guifi.net/sympa/info/guifi-gredos add dst-host=https://llistes.guifi.net/* add dst-host=http*://securityinabox.org/es*/* add dst-host=https://*llistes.guifi.net*/* add dst-host=https://llistes.guifi.net/sympa/subscribe/guifi-gredos add dst-host=https://llistes.guifi.net/sympa*/* add dst-host=https://llistes.guifi.net/sympa/* add dst-host=http://bin-short.whatsapp.net/ add dst-host=http://cepedadelamora.blogspot.com.es/ add dst-host=*.qui.guifi.net*/* /ip hotspot walled-garden ip add action=accept comment=10.0.0.0/8 disabled=no dst-address=10.0.0.0/8 !dst-port !protocol !src-address add action=accept comment=llistes.guifi.net disabled=no dst-address=109.69.12.15 !dst-port !protocol !src-address add action=accept comment=securityinabox.org disabled=no dst-address=88.198.62.144 !dst-port !protocol !src-address /ip ipsec policy set 0 dst-address=0.0.0.0/0 src-address=0.0.0.0/0 /ip proxy set cache-administrator=mail@gmail.com cache-path=web-proxy1 parent-proxy=0.0.0.0 /ip route add distance=1 gateway=10.228.150.1 /ip service set telnet disabled=yes set ftp address=0.0.0.0/0 disabled=yes set www address=192.168.1.0/24 set ssh address=0.0.0.0/0 disabled=yes set www-ssl address=0.0.0.0/0 certificate=cert1 disabled=no set api disabled=yes set winbox address=0.0.0.0/0 port=8291 set api-ssl disabled=yes /ip traffic-flow set active-flow-timeout=10m cache-entries=64k enabled=yes /ip traffic-flow target add dst-address=10.228.150.2 port=5556 /snmp set contact=guifi@guifi.net enabled=yes location=hostname /system clock set time-zone-autodetect=no time-zone-name=Europe/Madrid /system clock manual set dst-end=\u0026#34;feb/01/1970 00:00:00\u0026#34; dst-start=\u0026#34;feb/01/1970 00:00:00\u0026#34; /system identity set name=hostname /system logging add action=remote topics=critical add action=remote topics=error add action=remote topics=info add action=remote topics=warning add topics=e-mail add action=remote topics=e-mail add action=disk topics=critical add action=remote topics=firewall add action=disk topics=system add action=echo topics=warning /system note set note=\u0026#34;MMMMMMMMMMMMMMMMMMMMMXo,;:::;,;dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMMMMMWO;;OWMMWXo. :KMMMMMWKxoldkXWMMMMMMMMMMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMMMMKc\u0026#39;lXMMMMMMX: ;KMMMXo;dk\u0026#39; .cx0KNWMMMMMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMMMO,,OWMMMMMMMWo ,oxxcc0WWx..\u0026#39;. .,.,dXMMMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMMK;:XMMMMMMMMMMXc..;cokKWMMXkl:clcc, :XMMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMK:lXMMMMMMMMMMMM0\u0026#39; .:cod0NWd..;,..\u0026#39;;,. oNMMMMMMMMMMMMM\\ \\nMMMMMMMMMMMMMXx;oNMMMMMMMMMMMMNOl:;:::cooddl:;,,\u0026#39; .cl;.;oOKNWMMMMMMMM\\ \\nMMMMMMMMMW0olcl0WMMMMMMMMMMMMMWK0NX0OdoooolccloOKkl:dklcc,..,oddKMMMMM\\ \\nMMMMMMMMKc\u0026#39;:kXWMMMMMMMMMMMMMMMMMMMMMWx;\u0026#39;..:cclllodxolo,.\u0026#39;:. .,..oKWMM\\ \\nMMMMMMNd,:0WMMMMMMMMMMMMMMMMMMMMMMNXo. .cooll;..,codc,. .,\u0026#39;,;,\u0026#39;:ON\\ \\nMMMWXd::kWMMMMMMMMMMMMMMMMMMMMMMMM0l\u0026#39; \u0026#39;;;:oollc,,dOdl;\u0026#39;;clodoolk\\ \\nN0kdooONMMMMMMMMMMMMMMMMMMMMMMMMMWd,\u0026#39;.. \u0026#39;loldXNkolllokxookKKXWNK\\ \\nXK0XWMMMMMMMMMMMMMMMMMMMMMMMMMMWKOdccoxc. \u0026#39;dOkOXN0x0XK0NMMMMMMMMMM\\ \\nMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMKx0MXxdkxl:,::dKWMMWMMMWWMMMMMMMMMMMMM\\ \\n\u0026#34; /system ntp client set enabled=yes primary-ntp=158.227.98.15 secondary-ntp=193.136.164.1 /system ntp server set enabled=yes multicast=yes /system routerboard settings set silent-boot=no /system scheduler add comment=23:42:26 interval=23h54m name=LOG_MAIL on-event=\u0026#34;:local scheduleName \\\u0026#34;LOG_MAIL\\\u0026#34;\\r\\ \\n:local emailAddress \\\u0026#34;mail@gmail.com\\\u0026#34;\\r\\ \\n:local startBuf [:toarray [/log find message~\\\u0026#34;logged in\\\u0026#34; || message~\\\u0026#34;login failure\\\u0026#34;]]\\r\\ \\n:local removeThese (\\\u0026#34;\\\u0026#34;)\\r\\ \\n \\r\\ \\n:local lastTime [/system scheduler get [find name=\\\u0026#34;\\$scheduleName\\\u0026#34;] comment]\\r\\ \\n \\r\\ \\n:local currentBuf \\\u0026#34;\\\u0026#34;; :set currentBuf [:toarray \\$currentBuf]\\r\\ \\n \\r\\ \\n:foreach i in=\\$startBuf do={\\r\\ \\n :local toggle 1\\r\\ \\n :foreach j in=[:toarray \\$removeThese] do={\\r\\ \\n :if ([:typeof [:find [/log get \\$i message] \\\u0026#34;\\$j\\\u0026#34;]] = \\\u0026#34;num\\\u0026#34;) do={\\r\\ \\n :set toggle 0\\r\\ \\n }\\r\\ \\n }\\r\\ \\n :if (\\$toggle = 1) do={\\r\\ \\n :set currentBuf (\\$currentBuf , \\$i)\\r\\ \\n }\\r\\ \\n}\\r\\ \\n \\r\\ \\n:local currentLineCount [ :len \\$currentBuf ]\\r\\ \\n \\r\\ \\nif (\\$currentLineCount \u0026gt; 0) do={\\r\\ \\n :local currentTime \\\u0026#34;\\$[ /log get [ :pick \\$currentBuf (\\$currentLineCount -1) ] time ]\\\u0026#34;\\r\\ \\n \\r\\ \\n :if ([:len \\$currentTime] = 15 ) do={\\r\\ \\n :set currentTime [ :pick \\$currentTime 7 15 ]\\r\\ \\n }\\r\\ \\n \\r\\ \\n :local output \\\u0026#34;\\$currentTime \\$[/log get [ :pick \\$currentBuf (\\$currentLineCount-1) ] message ]\\\u0026#34;\\r\\ \\n \\r\\ \\n :if (([:len \\$lastTime] \u0026lt; 1) || (([:len \\$lastTime] \u0026gt; 0) \u0026amp;\u0026amp; (\\$lastTime != \\$currentTime))) do={\\r\\ \\n /system scheduler set [find name=\\\u0026#34;\\$scheduleName\\\u0026#34;] comment=\\$currentTime\\r\\ \\n /tool e-mail send to=\\\u0026#34;mail@gmail.com\\\u0026#34; port=25 server=74.125.133.108 user=mail@gmail.com password=password from=hostname start-tls=yes subject=\\\u0026#34;hostname_LOG \\$currentTime\\\u0026#34; body=\\\u0026#34;\\$output\\\u0026#34;\\r\\ \\n }\\r\\ \\n}\u0026#34; policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive start-time=startup add interval=23h53m name=SEND_BACKUP on-event=\u0026#34;/system script run SEND_BACKUP\u0026#34; policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive start-time=startup add comment=\u0026#34;REINICIO CADA DIA\u0026#34; interval=1d name=schedule1 on-event=\u0026#34;/system script run reiniciar\u0026#34; policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive start-date=jun/03/2016 start-time=06:00:00 /system script add dont-require-permissions=no name=console_detail owner=admin policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive source=\u0026#34;:local content\\r\\ \\n:local logcontenttemp \\\u0026#34;\\\u0026#34;\\r\\ \\n:local logcontent \\\u0026#34;\\\u0026#34;\\r\\ \\n:local counter\\r\\ \\n:local v 0\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;You are logged into: \\$[/system identity get name]\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;############### system health ###############\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;Uptime: \\$[/system resource get uptime] d:h:m:s\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34; | \\\u0026#34;)\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;CPU: \\$[/system resource get cpu-load]%\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;RAM: \\$(([/system resource get total-memory]-[/system resource get free-memory])/1024)/\\$([/system resource get total-memory]/1024)M\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34; | \\\u0026#34;)\\r\\ \\n \\r\\ \\n##\\r\\ \\n#voltage and temp readout not available on x86, check for this before trying\\r\\ \\n#to record otherwise script will halt unexpectedly\\r\\ \\n##\\r\\ \\n \\r\\ \\n:if ([/system resource get architecture-name]=\\\u0026#34;x86\\\u0026#34;) do={\\r\\ \\n :set logcontenttemp \\\u0026#34;Voltage: NIL\\\u0026#34;\\r\\ \\n :set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34; | \\\u0026#34;)\\r\\ \\n :set logcontenttemp \\\u0026#34;Temp: NIL\\\u0026#34;\\r\\ \\n :set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n} else={\\r\\ \\n :set logcontenttemp \\\u0026#34;Voltage: \\$[:pick [/system health get voltage] 0 2] v\\\u0026#34;\\r\\ \\n :set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34; | \\\u0026#34;)\\r\\ \\n :set logcontenttemp \\\u0026#34;Temp: \\$[ /system health get temperature]c\\\u0026#34;\\r\\ \\n :set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n}\\r\\ \\n \\r\\ \\n:set logcontenttemp \\\u0026#34;############# user auth details #############\\\u0026#34;\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n \\r\\ \\n:foreach counter in=[/ip hotspot active find ] do={:set v (\\$v + 1)}\\r\\ \\n:set logcontenttemp \\\u0026#34;Hotspot online: \\$v |\\\u0026#34;\\r\\ \\n:set v 0\\r\\ \\n:foreach counter in=[/ppp active find ] do={:set v (\\$v + 1)}\\r\\ \\n:set logcontenttemp (\\\u0026#34;\\$logcontenttemp\\\u0026#34; . \\\u0026#34; PPP online: \\$v\\\u0026#34;)\\r\\ \\n:set logcontent (\\\u0026#34;\\$logcontent\\\u0026#34; .\\\u0026#34;\\$logcontenttemp\\\u0026#34; .\\\u0026#34;\\\\n\\\u0026#34;)\\r\\ \\n \\r\\ \\n/system note set note=\\\u0026#34;\\$logcontent\\\u0026#34;\u0026#34; add dont-require-permissions=no name=reiniciar owner=admin policy=ftp,reboot,read,write,policy,test,password source=\u0026#34;/system reboot\u0026#34; add dont-require-permissions=no name=SEND_BACKUP owner=admin policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive source=\u0026#34;/system backup save name=hostname_email_backup dont-encrypt=no\\r\\ \\n/log print file=hostname_logmail.txt\\r\\ \\n\\r\\ \\n/tool e-mail send file=hostname_email_backup.backup to=mail@gmail.com port=25 server=74.125.133.108 user=mail@gmail.com password=password from=hostname start-tls=yes subject=hostname_backup_diario body=hostname_backup_diario\\r\\ \\n/tool e-mail send file=hostname_logmail.txt to=mail@gmail.com port=25 server=74.125.133.108 user=mail@gmail.com password=password from=hostname start-tls=yes subject=hostname_log_diario body=hostname_log_diario\u0026#34; add dont-require-permissions=no name=address_list_winbox-acces owner=admin policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive source=\u0026#34;ip firewall address-list print\u0026#34; /tool e-mail set address=74.125.133.108 from=hostname password=password start-tls=yes user=mail@gmail.com /tool graphing interface add add interface=bridge1 add add interface=ether1 add interface=ether3 add interface=ether4 add interface=ether5 add /tool graphing queue add simple-queue=2MB_down_384MB_up add simple-queue=queue1 /tool graphing resource add /tool mac-server set allowed-interface-list=mactel /tool mac-server mac-winbox set allowed-interface-list=mac-winbox /tool romon port add *\u0026gt;   Conclusi√≥n En este momento se intentan poner todas las facilidades posibles para que a pie de calle se pueda conectar al acceso abierto de la manera m√°s sencilla con cualquier dispositivo que cuente al menos con 802.11b.\nAl principio estaba el portal cautivo del hotspot con acceso limitado en tiempo y caudal (creo que eran 320k sim√©tricos para cada dispositivo por un tiempo de 2 horas al d√≠a por dispositivo), en esta gesti√≥n por MAC, el \u0026ldquo;cliente\u0026rdquo; ten√≠a que abrir una p√°gina cualquiera con el navegador del dispositivo y se le redireccionaba a la p√°gina del hotspot, despu√©s validarse en el hotspot con un link de pincha aqu√≠ para tener acceso, en fin, un l√≠o para cualquiera que quisiera conectarse a la wifi.\nTuve que poner un cartel en el bar con las indicaciones para conectarse: Parece que no tienes plugin para visualizar PDF en tu navegador.\rPuedes descargargar el archivo aqu√≠\n\rY se deshabilit√≥ el hotspot. Ahora para tener conexi√≥n a internet basta con conectar a la wifi. Hay un caudal l√≠mite para el global de todas las conexiones de acceso abierto, y el \"cliente\" cuando se quiere conectar solo tiene que conectar con el SSID del AP, se conecta a una wifi que no tiene contrase√±a, se asigna una IP y ya le funciona el WhatsApp y cualquier servicio de su dispositivo, antes para que funcionara el WhatsApp primero hab√≠a que conectase al portal cautivo con el navegador, y no val√≠a la barra de b√∫squeda de Google que usan muchos usuarios. Adem√°s que tener las conexiones limitadas en tiempo y caudal no tiene sentido hacerlo cuando hay poca demanda y es un caudal que se est√° desaprovechando. La gesti√≥n del tr√°fico en el acceso abierto se hace por QoS se asignan prioridades dependiendo del servicio.\nSi tuvi√©ramos 100 o 200 Mb de salida a internet no tendr√≠amos estos problemas y a pie de calle el grifo estar√≠a abierto a demanda, pero la salida a internet es limitada y requiere de gesti√≥n por QoS para evitar la congesti√≥n, llega un momento que se satura y deja de funcionar.\nLo que tenemos actualmente, en 2021, es un una salida global a internet por telefon√≠a m√≥vil que falla cuando quiere y que hay que repartir entre muchas conexiones. Hay un caudal limitado para el total de conexiones a pie de calle del hotspot y el resto es para las conexiones residenciales.\nEl invento funciona m√°s o menos 335 d√≠as al a√±o, hay 30 d√≠as cuando llegan las temporadas de m√°xima concurrencia de conexiones que da igual lo que tengas configurado porque la salida a internet es la misma todo el a√±o y no da para m√°s.\nPor ejemplo, en verano que son las temporadas de pico m√°ximo, con 30 nodos residenciales a 4 dispositivos de media por nodo son 120 dispositivos residenciales + de 20 a 40 dispositivos del hotspot son 150 dispositivos que tienen que salir a internet por una conexi√≥n que est√° dimensionada para tener de 1 a 4 dispositivos.\nQue quede claro que yo no soy partidario hacer gesti√≥n del tr√°fico en ning√∫n sitio y mucho menos en una red comunitaria, pero la salida a internet es la que es y hay momentos en los que hay muchas bocas que alimentar.\nSon los usuarios los que se tienen que responsabilizar de su uso.\nAhora en 2021, lo siguiente que voy a hacer es quitar el l√≠mite de caudal global de las conexiones del hotspot, porque quien soy yo para decidir que l√≠mite de datos tiene que haber en una conexi√≥n que est√° pagando el excelent√≠simo Ayto de Cepeda de la Mora para uso y disfrute de todos sus vecinos, el mismo derecho tienen los que est√°n en el cuarto de ba√±o de su casa que los que est√°n en la plaza del pueblo (ahora por orden de la diputaci√≥n se quit√≥ el AP de la plaza, dicen que es para evitar aglomeraciones de adolescentes), porque a lo mejor no quieren o no se pueden permitir tener un nodo propio en su casa.\nUna posible soluci√≥n a este problema de concurrencia seria aplicar QoS din√°micas en las que se hiciera la gesti√≥n del tr√°fico por prioridad, tiempo y caudal, bas√°ndose en el n√∫mero de conexiones y demanda de cada momento, pero volvemos a lo mismo. En una red comunitaria ni yo ni nadie tiene que decidir s√≠ un tipo de tr√°fico tiene m√°s o menos prioridad que otro.\n\n","description":"hotspot","id":20,"section":"posts","tags":["guifi.net","hotspot","mikrotik"],"title":"Hotspot","uri":"https://hotspotcepeda.github.io/es/posts/hotspot/"},{"content":"En este art√≠culo se comenta como intent√© buscar el apoyo en asociaciones locales para que promovieran la iniciativa de una red de telecomunicaciones comunitaria, de alguna manera, para conseguir tener una wifi p√∫bica, un acceso p√∫blico a internet en un √°rea rural desfavorecida. Por aquel entonces las conexiones a internet en Cepeda se hac√≠an mediante el ISP Iberbanda (que daba conexiones de 1 2 y 3 Mb sim√©tricos), y el 3G era un lujo.\nContactos Hab√≠an pasado unos cuantos de a√±os desde que vi la p√°gina de guifi.net por primera vez y navegando por la internet lo volv√≠ a ver, ahora hab√≠a un mont√≥n de nodos y la tela de ara√±a se estaba extendiendo incluso fuera de Catalu√±a. A m√≠ me gustaba la idea de la red libre abierta y neutral pero no ten√≠a ni idea de como empezar.\nEn Catalu√±a guifi.net llevaba 10 a√±os funcionando y el proyecto iba creciendo.\nYo acababa de ser despedido de manera improcedente de una empresa de telecomunicaciones en la que me dedicaba a instalar equipos de wifi para dar cobertura a nivel poblaci√≥n e interconectar dependencias municipales, ten√≠a mucha rabia acumulada y estaba viendo una sonrisa en los pueblos que ten√≠an wifi, la verdad es que era un trabajo que me gustaba mucho y me fastidi√≥ cuando me dijeron que me dejaban en la calle.\nHubo una persona que me sugiri√≥ la idea de la wifi comunitaria y fue entonces cuando se me meti√≥ en la cabeza la idea de aportar mi experiencia al pueblo que me hab√≠a visto crecer y del que estoy tan orgulloso.\nNo ten√≠a ni idea de como empezar, as√≠ que pens√© que contactar con asociaciones locales me pod√≠a iluminar y que iban a apoyar mi idea, que no era otra que compartir una salida a internet y ponerla a disposici√≥n del que la necesitara.\nAs√≠ qu√©, Intent√© buscar aliados, para por lo menos, presentar una propuesta.\n Lo primero contact√© con la asociaci√≥n El Royo de Cepeda la Mora, la asociaci√≥n m√°s potente del pueblo https://www.facebook.com/elrollodecepeda/, se enviaron 2 correos a elrollodecepeda@gmail.com comentando la idea de la wifi en el pueblo y hablando del proyecto guifi.net, sin respuesta. Contact√© con ASENORG, Asociaci√≥n Empresarios Gredos al mail de Isabel S√°nchez Tejado isabelstejado@gmail.com, que era el que hab√≠a de contacto, sin respuesta (Ahora esta persona se dedica a \u0026ldquo;el cultivo de Piornos (no te pierdas nuestro Festival del Piorno)\u0026rdquo;. Me parto. Seg√∫n https://repueblo.es/cracksrurales/la-inspiradora-historia-de-una-repobladora-en-gredos). Y con voluntariadogredoslibre@gmail.com, sin respuesta, claro.  Eran las asociaciones locales que hab√≠a en aquella √©poca.\nTener el respaldo de una asociaci√≥n consolidada dar√° fuerza al proyecto. Si no hay nada, es muy interesante contemplar la posibilidad de crear una fundaci√≥n, asociaci√≥n, cooperativa, grupo o colectivo de usuarios para fomentar la implicaci√≥n del grupo y para repartir la carga de trabajo. Tomar de decisiones es m√°s f√°cil cuando no est√°s solo. Pero tambi√©n ten en cuenta que si viajas solo, podr√°s volar a donde quieras y estar el tiempo que te d√© la gana.\nguifi.net Tambi√©n contact√© con guifi.net fundacio@guifi.net, sin respuesta. Descubr√≠ que las comunicaciones en guifi.net se hac√≠an mediante las listas de correo https://llistes.guifi.net/sympa y tiene sentido, es interesante tener un repositorio de informaci√≥n para poder hacer b√∫squedas y navegaci√≥n de hilos. Aunque las listas de correo son cada vez menos populares se siguen usando.\nY con la agrupaci√≥n guifi.net Extremadura, mediante las listas de correo ya hubo algo de di√°logo.\nUn d√≠a me present√© en el MediaLab Prado, un sitio maravilloso lleno de gente extraordinaria que el Ayto. de Madrid quiere desalojar para convertirlo en un museo, est√° claro que este pa√≠s no tiene mucho inter√©s en la cultura y que todo est√° orientado a vivir del turismo, un pa√≠s que es el chiringuito de Europa, con sol, playa y el producto estrella: El folclore.\nFinalmente con el apoyo de Gabi y Alex, las personas que conoc√≠ en el MediaLab Prado, se present√≥ una propuesta al ayuntamiento de Cepeda para poner un hotspot y un par de AP en 2.4 para conexi√≥n wifi p√∫blica a pie de calle, una antena en la plaza del Ayto. y otra en el bar municipal. La salida a internet la donaba el ayuntamiento que ten√≠a contratada una conexi√≥n de 3 Mb sim√©tricos y que la mayor√≠a del tiempo estaba sin uso.\nPara desplegar una red comunitaria local wireless vas a necesitar tener alg√∫nos conocimientos.\nHay un libro publicado bajo licencia Creative Commons que a m√≠ me gust√≥ mucho, \u0026ldquo;Redes inal√°mbricas en los pa√≠ses en desarrollo.\u0026rdquo;\nEs gratis y est√° traducido al espa√±ol y a muchos m√°s idiomas, se puede descargar en http://wndw.net/book.html\nTampoco es necesario que te conviertas en un experto en telecomunicaciones, para desplegar y mantener la red puedes contratar a un profesional de tu zona, qu√© para eso est√°n.\nIgualmente hay que valorar el tipo de despliegue que se quiere hacer y las necesidades que se quieren cubrir, por ejemplo, cada vez es m√°s barato desplegar con fibra √≥ptica.","description":"arrancando","id":21,"section":"posts","tags":["guifi.net","asociaciones"],"title":"Arrancando","uri":"https://hotspotcepeda.github.io/es/posts/arrancando/"}]